import object_storage
import re
import os
import time, datetime
from swift_cred import sl_user_name, sl_api_key, sl_data_center
from pprint import pprint
import simplejson


forecast_cols = ["clouds", "detailed_status", "dewpoint", "heat_index", "humidex", "humidity", "pressure_pres", "pressure_sea_level", "rain", "reference_time", "snow", "status", "sunrise_time", "sunset_time", "temperature_temp", "temperature_temp_kf", "temperature_temp_max", "temperature_temp_min", "visibility_dist", "weather_code", "wind_deg", "wind_speed"]

col_names = ['reception_time', 'location']
for i in range(40):
	col_names += [c+"_"+str((i+1)*3) for c in forecast_cols]

print len(col_names)

values = ["%s" for i in range(len(col_names))]

print len(values)

col_names = "("+", ".join(col_names)+")"
values = "("+", ".join(values)+")"


text = """{"reception_time": 1435579256, "interval": "3h", "Location": {"country": "US", "name": "Brisbane", "coordinates": {"lat": 37.680771, "lon": -122.399971}, "ID": 5330810}, "weathers": [{"status": "rain", "visibility_distance": null, "humidity": 100, "clouds": 88, "temperature": {"temp_kf": 2.4, "temp_max": 287.72, "temp": 287.72, "temp_min": 285.322}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435568400, "weather_code": 500, "humidex": null, "rain": {"3h": 0.13}, "sunset_time": 0, "pressure": {"press": 1021.5, "sea_level": 1030.03}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10n", "wind": {"speed": 1.51, "deg": 225.008}}, {"status": "rain", "visibility_distance": null, "humidity": 100, "clouds": 92, "temperature": {"temp_kf": 1.92, "temp_max": 287.52, "temp": 287.52, "temp_min": 285.6}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435579200, "weather_code": 500, "humidex": null, "rain": {"3h": 0.205}, "sunset_time": 0, "pressure": {"press": 1021.43, "sea_level": 1029.96}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10n", "wind": {"speed": 1.52, "deg": 237}}, {"status": "rain", "visibility_distance": null, "humidity": 99, "clouds": 80, "temperature": {"temp_kf": 1.44, "temp_max": 287.91, "temp": 287.91, "temp_min": 286.473}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435590000, "weather_code": 500, "humidex": null, "rain": {"3h": 0.17}, "sunset_time": 0, "pressure": {"press": 1021.98, "sea_level": 1030.57}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10d", "wind": {"speed": 1.87, "deg": 258.506}}, {"status": "rain", "visibility_distance": null, "humidity": 83, "clouds": 0, "temperature": {"temp_kf": 0.96, "temp_max": 290.61, "temp": 290.61, "temp_min": 289.649}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435600800, "weather_code": 500, "humidex": null, "rain": {"3h": 0.04}, "sunset_time": 0, "pressure": {"press": 1022.01, "sea_level": 1030.33}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10d", "wind": {"speed": 2.17, "deg": 251.001}}, {"status": "rain", "visibility_distance": null, "humidity": 72, "clouds": 0, "temperature": {"temp_kf": 0.48, "temp_max": 292.69, "temp": 292.69, "temp_min": 292.209}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435611600, "weather_code": 500, "humidex": null, "rain": {"3h": 0.01}, "sunset_time": 0, "pressure": {"press": 1020.84, "sea_level": 1029.17}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10d", "wind": {"speed": 3.27, "deg": 252.001}}, {"status": "clear", "visibility_distance": null, "humidity": 70, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 292.036, "temp": 292.036, "temp_min": 292.036}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435622400, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1019.76, "sea_level": 1027.89}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 3.76, "deg": 252.503}}, {"status": "clear", "visibility_distance": null, "humidity": 80, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 289.522, "temp": 289.522, "temp_min": 289.522}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435633200, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1019.14, "sea_level": 1027.34}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 2.28, "deg": 240.007}}, {"status": "clear", "visibility_distance": null, "humidity": 100, "clouds": 8, "temperature": {"temp_kf": null, "temp_max": 285.559, "temp": 285.559, "temp_min": 285.559}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435644000, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1019.45, "sea_level": 1027.83}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "02n", "wind": {"speed": 1.66, "deg": 219.501}}, {"status": "clouds", "visibility_distance": null, "humidity": 100, "clouds": 44, "temperature": {"temp_kf": null, "temp_max": 284.46, "temp": 284.46, "temp_min": 284.46}, "dewpoint": null, "snow": {}, "detailed_status": "scattered clouds", "reference_time": 1435654800, "weather_code": 802, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.43, "sea_level": 1027}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "03n", "wind": {"speed": 1.31, "deg": 219.5}}, {"status": "rain", "visibility_distance": null, "humidity": 100, "clouds": 80, "temperature": {"temp_kf": null, "temp_max": 284.577, "temp": 284.577, "temp_min": 284.577}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435665600, "weather_code": 500, "humidex": null, "rain": {"3h": 0.05}, "sunset_time": 0, "pressure": {"press": 1017.65, "sea_level": 1026.22}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10n", "wind": {"speed": 1.21, "deg": 174.002}}, {"status": "rain", "visibility_distance": null, "humidity": 100, "clouds": 56, "temperature": {"temp_kf": null, "temp_max": 285.134, "temp": 285.134, "temp_min": 285.134}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435676400, "weather_code": 500, "humidex": null, "rain": {"3h": 0.09}, "sunset_time": 0, "pressure": {"press": 1017.86, "sea_level": 1026.37}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10d", "wind": {"speed": 1.16, "deg": 182.505}}, {"status": "rain", "visibility_distance": null, "humidity": 77, "clouds": 8, "temperature": {"temp_kf": null, "temp_max": 291.446, "temp": 291.446, "temp_min": 291.446}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435687200, "weather_code": 500, "humidex": null, "rain": {"3h": 0.02}, "sunset_time": 0, "pressure": {"press": 1017.85, "sea_level": 1026.24}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10d", "wind": {"speed": 1.16, "deg": 207.001}}, {"status": "clouds", "visibility_distance": null, "humidity": 62, "clouds": 12, "temperature": {"temp_kf": null, "temp_max": 295.879, "temp": 295.879, "temp_min": 295.879}, "dewpoint": null, "snow": {}, "detailed_status": "few clouds", "reference_time": 1435698000, "weather_code": 801, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1016.54, "sea_level": 1024.94}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "02d", "wind": {"speed": 1.56, "deg": 249.005}}, {"status": "clear", "visibility_distance": null, "humidity": 58, "clouds": 8, "temperature": {"temp_kf": null, "temp_max": 296.344, "temp": 296.344, "temp_min": 296.344}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435708800, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1015.19, "sea_level": 1023.52}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "02n", "wind": {"speed": 1.8, "deg": 246}}, {"status": "rain", "visibility_distance": null, "humidity": 65, "clouds": 8, "temperature": {"temp_kf": null, "temp_max": 293.477, "temp": 293.477, "temp_min": 293.477}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435719600, "weather_code": 500, "humidex": null, "rain": {"3h": 0.005}, "sunset_time": 0, "pressure": {"press": 1015.08, "sea_level": 1023.37}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10n", "wind": {"speed": 1.35, "deg": 240}}, {"status": "rain", "visibility_distance": null, "humidity": 90, "clouds": 8, "temperature": {"temp_kf": null, "temp_max": 288.165, "temp": 288.165, "temp_min": 288.165}, "dewpoint": null, "snow": {}, "detailed_status": "light rain", "reference_time": 1435730400, "weather_code": 500, "humidex": null, "rain": {"3h": 0.0125}, "sunset_time": 0, "pressure": {"press": 1015.98, "sea_level": 1024.25}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "10n", "wind": {"speed": 1.46, "deg": 224.003}}, {"status": "clear", "visibility_distance": null, "humidity": 100, "clouds": 8, "temperature": {"temp_kf": null, "temp_max": 285.485, "temp": 285.485, "temp_min": 285.485}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435741200, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1015.71, "sea_level": 1024.22}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "02n", "wind": {"speed": 1.21, "deg": 219.5}}, {"status": "clouds", "visibility_distance": null, "humidity": 100, "clouds": 36, "temperature": {"temp_kf": null, "temp_max": 285.476, "temp": 285.476, "temp_min": 285.476}, "dewpoint": null, "snow": {}, "detailed_status": "scattered clouds", "reference_time": 1435752000, "weather_code": 802, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1015.62, "sea_level": 1024.09}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "03n", "wind": {"speed": 0.41, "deg": 250.502}}, {"status": "clear", "visibility_distance": null, "humidity": 88, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 288.901, "temp": 288.901, "temp_min": 288.901}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435762800, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1016.28, "sea_level": 1024.68}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01d", "wind": {"speed": 0.67, "deg": 184.5}}, {"status": "clear", "visibility_distance": null, "humidity": 62, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 295.28, "temp": 295.28, "temp_min": 295.28}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435773600, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1016.68, "sea_level": 1025.16}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01d", "wind": {"speed": 1.16, "deg": 230.005}}, {"status": "clear", "visibility_distance": null, "humidity": 53, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 297.385, "temp": 297.385, "temp_min": 297.385}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435784400, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1016.57, "sea_level": 1024.85}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01d", "wind": {"speed": 2.41, "deg": 239.501}}, {"status": "clear", "visibility_distance": null, "humidity": 54, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 296.405, "temp": 296.405, "temp_min": 296.405}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435795200, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1016.09, "sea_level": 1024.35}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 2.41, "deg": 239.015}}, {"status": "clear", "visibility_distance": null, "humidity": 66, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 293.181, "temp": 293.181, "temp_min": 293.181}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435806000, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1016.48, "sea_level": 1024.66}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 1.86, "deg": 236.501}}, {"status": "clear", "visibility_distance": null, "humidity": 87, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 289.162, "temp": 289.162, "temp_min": 289.162}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435816800, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1017.6, "sea_level": 1025.75}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 0.97, "deg": 230.506}}, {"status": "clear", "visibility_distance": null, "humidity": 97, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 287.397, "temp": 287.397, "temp_min": 287.397}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435827600, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1017.08, "sea_level": 1025.39}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 1.32, "deg": 241.001}}, {"status": "clouds", "visibility_distance": null, "humidity": 100, "clouds": 12, "temperature": {"temp_kf": null, "temp_max": 286.636, "temp": 286.636, "temp_min": 286.636}, "dewpoint": null, "snow": {}, "detailed_status": "few clouds", "reference_time": 1435838400, "weather_code": 801, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1017.1, "sea_level": 1025.29}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "02n", "wind": {"speed": 1, "deg": 223.5}}, {"status": "clouds", "visibility_distance": null, "humidity": 89, "clouds": 44, "temperature": {"temp_kf": null, "temp_max": 289.077, "temp": 289.077, "temp_min": 289.077}, "dewpoint": null, "snow": {}, "detailed_status": "scattered clouds", "reference_time": 1435849200, "weather_code": 802, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.08, "sea_level": 1026.34}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "03d", "wind": {"speed": 1.21, "deg": 206.514}}, {"status": "clouds", "visibility_distance": null, "humidity": 72, "clouds": 48, "temperature": {"temp_kf": null, "temp_max": 292.688, "temp": 292.688, "temp_min": 292.688}, "dewpoint": null, "snow": {}, "detailed_status": "scattered clouds", "reference_time": 1435860000, "weather_code": 802, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.59, "sea_level": 1026.82}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "03d", "wind": {"speed": 1.4, "deg": 222.501}}, {"status": "clouds", "visibility_distance": null, "humidity": 65, "clouds": 80, "temperature": {"temp_kf": null, "temp_max": 294.276, "temp": 294.276, "temp_min": 294.276}, "dewpoint": null, "snow": {}, "detailed_status": "broken clouds", "reference_time": 1435870800, "weather_code": 803, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.47, "sea_level": 1026.66}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "04d", "wind": {"speed": 3.92, "deg": 227.003}}, {"status": "clouds", "visibility_distance": null, "humidity": 74, "clouds": 92, "temperature": {"temp_kf": null, "temp_max": 292.261, "temp": 292.261, "temp_min": 292.261}, "dewpoint": null, "snow": {}, "detailed_status": "overcast clouds", "reference_time": 1435881600, "weather_code": 804, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1019.05, "sea_level": 1027.23}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "04n", "wind": {"speed": 5.02, "deg": 223.008}}, {"status": "clouds", "visibility_distance": null, "humidity": 80, "clouds": 64, "temperature": {"temp_kf": null, "temp_max": 290.931, "temp": 290.931, "temp_min": 290.931}, "dewpoint": null, "snow": {}, "detailed_status": "broken clouds", "reference_time": 1435892400, "weather_code": 803, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1019.99, "sea_level": 1028.45}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "04n", "wind": {"speed": 4.68, "deg": 218.003}}, {"status": "clouds", "visibility_distance": null, "humidity": 92, "clouds": 48, "temperature": {"temp_kf": null, "temp_max": 288.539, "temp": 288.539, "temp_min": 288.539}, "dewpoint": null, "snow": {}, "detailed_status": "scattered clouds", "reference_time": 1435903200, "weather_code": 802, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1020.06, "sea_level": 1028.27}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "03n", "wind": {"speed": 1.21, "deg": 315.501}}, {"status": "clear", "visibility_distance": null, "humidity": 95, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 288.064, "temp": 288.064, "temp_min": 288.064}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435914000, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.87, "sea_level": 1027.22}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 1.2, "deg": 125.503}}, {"status": "clear", "visibility_distance": null, "humidity": 91, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 288.082, "temp": 288.082, "temp_min": 288.082}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435924800, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.23, "sea_level": 1026.61}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01n", "wind": {"speed": 1.62, "deg": 209.003}}, {"status": "clear", "visibility_distance": null, "humidity": 86, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 289.602, "temp": 289.602, "temp_min": 289.602}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435935600, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.57, "sea_level": 1026.93}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01d", "wind": {"speed": 1.67, "deg": 246}}, {"status": "clear", "visibility_distance": null, "humidity": 72, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 292.819, "temp": 292.819, "temp_min": 292.819}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435946400, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.9, "sea_level": 1027.07}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01d", "wind": {"speed": 1.86, "deg": 237.001}}, {"status": "clear", "visibility_distance": null, "humidity": 64, "clouds": 0, "temperature": {"temp_kf": null, "temp_max": 294.49, "temp": 294.49, "temp_min": 294.49}, "dewpoint": null, "snow": {}, "detailed_status": "sky is clear", "reference_time": 1435957200, "weather_code": 800, "humidex": null, "rain": {"3h": 0}, "sunset_time": 0, "pressure": {"press": 1018.19, "sea_level": 1026.35}, "sunrise_time": 0, "heat_index": null, "weather_icon_name": "01d", "wind": {"speed": 3.91, "deg": 242.003}}]}"""

raw = simplejson.loads(text)

pprint(raw)

print len(raw['weathers'])


a = ('1', '2', '3', '4')

if len(a) < 6:
	app = tuple(('Null' for i in range(6 - len(a))))
	print app
	a += app
print a

#sl_storage = object_storage.get_client(sl_user_name, sl_api_key, datacenter = sl_data_center)
#
#dump_container = 'bart_dump'
#archive_container = 'bart_archive'
#
##grab all fetchtimes
#fts_pre = sl_storage[dump_container].objects()
#fts = []
#
#print "Grabbing list of fetch_time files..."
#for pre in fts_pre:
#	prestr = pre.__str__()
#	try:
#		match = re.search(dump_container + ', (fetch_times_.*)\.txt', prestr)
#		fts.append(match.group(1) + '.txt')
#	except:
#		pass
#
#
##for each fetchtime
#for ft in fts:
#	print "Reading " + ft









#for f in fts:
#	sl_storage[dump_container][f].delete()




#to_send = os.walk('../data/sentdata').next()[1]
#to_send = [x for x in to_send if '2015-06-29' in x]
#print to_send

#print "Sending files for archive container..."
#for i, item in enumerate(to_send):
#	print "Sending file " + str(i + 1) + ": " + item
#	fullfilename = 'to_parse/' + item
#	with open(fullfilename, 'r') as readfile:
#		sl_storage[archive_container][readfile.name.split('/')[-1]].send(readfile)
#print 'Data files sent to object store.'